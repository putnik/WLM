{% extends "empty.html" %}

{% block content %}
<h1>{{ street.full_name }}</h1>
{% if map_center %}
<div id="map" class="map"></div>
<script type="text/javascript">
	var cmUrl = 'http://{s}.tile.cloudmade.com/{{ CMADE_KEY }}/997/256/{z}/{x}/{y}.png';
	var cmAttr = 'карта &copy; OpenStreetMap, рендер &copy; CloudMade';
	var map = new L.Map('map');
	map
		.setView(new L.LatLng({{ map_center.lat|stringformat:"f" }}, {{ map_center.lon|stringformat:"f" }}), 15)
		.addLayer(new L.TileLayer(cmUrl, { maxZoom: 18, attribution: cmAttr }));

{% for house in list %}
	{% if house.coord_lat %}
		map.addLayer(new L.Marker(new L.LatLng({{ house.coord_lat|stringformat:"f" }}, {{ house.coord_lon|stringformat:"f" }})));
	{% endif %}
{% endfor %}
</script>
{% endif %}

{% if street.description %}
<div class="text">
	{{ street.description }}
</div>
{% endif %}

<table class="info">
	<thead>
		<tr>
			<th>Номер</th>
			<th>Состояние</th>
			<th>Категория охраны</th>
		</tr>
	</thead>
	<tbody>
	{% for house in list %}
		<tr class="{% cycle 'odd' 'even' %}">
			<th><a href="/house/{{ house.id }}">{{ house.number }}</a></th>
		{% if house.state and house.safety == 'S' %}
			<td class="state-{{ house.state }}">{{ house.get_state_display }}</td>
		{% else %}
			<td class="safety-{{ house.safety }}">{{ house.get_safety_display }}</td>
		{% endif %}
			<td {% if house.protection == 'N' %}class="shady"{% endif %}>{{ house.get_protection_display }}</td>
		</tr>
	{% endfor %}
	</tbody>
</table>
{% endblock %}
